{% extends 'base.html' %}
{% block title %}Login{% endblock %}

{% block content %}
<div class="container">
    <h2>Iniciar sesión</h2>

    {% if mensaje %}
    <p style="color:red; font-weight:bold; margin-bottom:15px;">{{ mensaje }}</p>
    {% endif %}

    <form method="post" action="{% url 'procesar_login' %}">
        {% csrf_token %}
        <div class="row">
            <label for="rut">RUT:</label>
            <input type="text" id="txtrut" name="txtrut" placeholder="Ej: 12345678-9" maxlength="12"
                pattern="^[0-9]{7,8}-[0-9kK]$" required>
        </div>

        <div class="row">
            <label for="txtpas">Contraseña:</label>
            <input type="password" id="txtpas" name="txtpas" placeholder="Ingrese su contraseña" required>
        </div>

        <div class="actions">
            <button type="submit">Ingresar</button>
        </div>
    </form>
</div>

<script>
    document.getElementById("txtrut").addEventListener("input", function () {
        let v = this.value;
        v = v.replace(/[^0-9kK\-]/g, "");
        let parts = v.split("-");
        if (parts.length > 2) {
            v = parts[0] + "-" + parts[1];
        }
        this.value = v;
    });
</script>
{% endblock %}